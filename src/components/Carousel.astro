---
import { Image } from '@astrojs/image/components'
import Type from '@/components/Type.astro'
import Carousel from '@/components/Carousel.jsx'

type Slide = {
  imageSrc: string | Promise<any> | ImageMetadata
  caption?: string
}

export interface Props {
  slides: Slide[]
}

const { slides } = Astro.props
---

<Carousel client:only>
  {
    slides.map((slide) => (
      <figure>
        <Image
          src={slide.imageSrc}
          loading="lazy"
          alt={slide.caption || ''}
          format="webp"
        />
        <Type Element="figcaption" type="label">
          {slide.caption}
        </Type>
      </figure>
    ))
  }
</Carousel>

<style lang="scss">
  @import '../assets/styles/_index.scss';
  :global(.carousel) {
    img {
      width: 100%;
      height: auto;
    }
    :global(figcaption) {
      margin: 0.8em 0 0;
      max-width: 42ch;
    }
    :global(.flickity-viewport) {
      transition: height 255ms;
    }
    :global(.flickity-page-dots) {
      justify-content: flex-start;
      :global(.flickity-page-dot:first-child) {
        margin-left: 0;
      }
    }
  }
</style>
